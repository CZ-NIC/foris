{% extends 'config/base.html.j2' %}

{% block config_base %}
{% if is_xhr is not defined %}
<div id="page-config" class="config-page">
{% endif %}
    <form id="main-form" class="config-form" action="{{ request.fullpath }}" method="post" autocomplete="off" novalidate>
        <p class="config-description">{{ description|safe }}</p>
        {% include '_messages.html.j2' %}
        <input type="hidden" name="csrf_token" value="{{ get_csrf_token() }}">
        {% for field in form.active_fields %}
            {% include '_field.html.j2' %}
        {% endfor %}
        <div id="{{ 'form-%s-buttons' % form.name }}" class="form-buttons">
            <a href="{{ request.fullpath }}" class="button grayed">{% trans %}Discard changes{% endtrans %}</a>
            <button type="submit" name="send" class="button">{% trans %}Save changes{% endtrans %}</button>
        </div>
    </form>
{% if is_xhr is not defined %}
    {% if form.current_data["mode"] == "unmanaged" and form.current_data["client_proto_4"] != "none" %}
        {% set ipv6_test = False %}
        {% include "config/_connection_test.html.j2" %}
    {% endif %}
    {% if form.current_data["mode"] == "managed"  and form.current_data["router_dhcp_enabled"] %}
    <h3>{% trans %}DHCP clients{% endtrans %}</h3>
      {% if dhcp_clients %}
      <table>
        <thead>
          <tr>
            <th>{% trans %}Expires{% endtrans %}</th>
            <th>{% trans %}IP Address{% endtrans %}</th>
            <th>{% trans %}MAC Address{% endtrans %}</th>
            <th>{% trans %}Hostname{% endtrans %}</th>
            <th>{% trans %}Active{% endtrans %}</th>
          </tr>
        </thead>
        <tbody>
            {% for dhcp_client in dhcp_clients %}
            <tr>
                <td>{{ dhcp_client.expires }}</td>
                <td>{{ dhcp_client.ip }}</td>
                <td>{{ dhcp_client.mac }}</td>
                <td>{{ dhcp_client.hostname }}</td>
                <td><i class="fas {%if dhcp_client.active %}fa-check{% else %}fa-times{% endif %}"></span></td>
            </tr>
            {% endfor %}
        </tbody>
      </table>
      {% else %}
      {% trans %}No DHCP clients currently found.{% endtrans %}
      {% endif %}
    {% endif %}
</div>
{% endif %}
{% endblock %}
